% change document class to ctexbook for Chinese support
\documentclass[a4paper]{ctexbook}
% \usepackage[
%     textwidth=\textwidth,
%     textheight=\textheight,
%     paperwidth=\dimexpr\textwidth+0.1cm,
%     paperheight=\dimexpr\textheight+0.1cm
%     ]{geometry}
\usepackage[top=1in,bottom=1in,inner=1in,outer=2in]{geometry}
\usepackage[UTF8, fontset=windows]{ctex}
\punctstyle{kaiming}
\let\fangsong\relax
\let\kaishu\relax
\newCJKfontfamily\fangsong{simfang.ttf}[BoldFont=simhei.ttf]
\newCJKfontfamily\kaishu{FZXKTK.TTF}[BoldFont=simhei.ttf]
\setCJKmainfont{FZSSK.TTF}[BoldFont=simhei.ttf, ItalicFont=FZXKTK.TTF]
% \usepackage[no-math]{fontspec}
% \setmainfont{Times New Roman}

% FIXME: cannot find Source Han Sans even if it has been installed
% \setCJKsansfont{SourceHanSansCN-Regular.otf}[BoldFont=SourceHanSansCN-Bold.otf]

\raggedbottom % do not fill whole page
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}

\usepackage{xcolor}
\definecolor{fudanBlue}{RGB}{14,65,156}
\definecolor{fudanRed}{RGB}{204,26,26}
\definecolor{fudanOrange}{RGB}{243,152,0}
\definecolor{fudanYellow}{RGB}{253,209,8}
\newcommand\boldtext[1]{\textcolor{fudanBlue}{\textbf{#1}}\index{#1}}

\usepackage{tikz}
\usetikzlibrary{arrows.meta}
\usepackage{siunitx}
\usepackage{makeidx}
\makeindex
\usepackage{nomencl}
\usepackage{titlesec}
\usepackage{titletoc}
% indented subsection (in toc)
\titlecontents{chapter}
[0.0cm]             % left margin
{\vspace{1cm}\large\color{fudanBlue}\sffamily}                  % above code
{%                  % numbered format
{{\scshape Chapter} \thecontentslabel ~---~}%
}%
{}         % unnumbered format
{}         % filler-page-format, e.g dots
% indented subsection (in toc)
\titlecontents*{subsection}
[1.0cm]             % left margin
{\small\kaishu}                  % above code
{%                  % numbered format
{\thecontentslabel ~ }%
}%
{}         % unnumbered format
{ (\thecontentspage) $\quad$}         % filler-page-format
[~]

% math
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{amssymb} % geqslant
\usepackage{amsfonts}
\usepackage[nofontspec]{newpxtext} % must modify the newtxtext % ref: https://bbs.pku.edu.cn/v2/post-read.php?bid=346&threadid=18179665
\usepackage{newpxmath}
\usepackage[version=4]{mhchem}
\usepackage{cases}
\usepackage{esint}
\newcommand\ii{\vmathbb{i}}
\newcommand\ee{\vmathbb{e}}
\newcommand\dd{\mathrm{d}}
\renewcommand\AA{\hat A}
\newcommand\BB{\hat B}
\newcommand\CC{\hat C}
\newcommand\DD{\hat D}
\newcommand\intinf{\int_{- \infty}^{+ \infty}}
\usepackage{physics} % pdv, ...
\usepackage{braket}
\usepackage{bm}
\newtheorem{theorem}{Theorem}
\usepackage{mathrsfs}
\usepackage{mathtools} % text over rightarrow
\usepackage{braket}
\numberwithin{equation}{section}
% reduce equation spaces
\makeatletter
\g@addto@macro\normalsize{%
  \setlength\abovedisplayskip{3pt}
  \setlength\belowdisplayskip{3pt}
  \setlength\abovedisplayshortskip{1pt}
  \setlength\belowdisplayshortskip{1pt}
}
\makeatother
% \allowdisplaybreaks[4]

\usepackage{booktabs}
\usepackage{array} % table for align center vertically
\usepackage{multirow}
% tikz
\usetikzlibrary{decorations.pathmorphing,patterns}

% caption
\usepackage{caption}
\DeclareCaptionFont{fang}{\fangsong}
\captionsetup{font={small,fang,stretch=1.3},labelfont={sf,color=fudanBlue},labelsep=quad}
\captionsetup[table]{skip=3pt}
\captionsetup[figure]{skip=10pt}

% section title
\usepackage{titlesec}
\titleformat{\chapter}[display]
  {\normalfont\sffamily\huge\color{fudanBlue}}
  {\chaptertitlename\ \thechapter}{20pt}{\Huge}
\titleformat{\section}
  {\normalfont\sffamily\Large\color{fudanBlue}}
  {\thesection}{1em}{}

\usepackage{wrapfig}
\usepackage{tcolorbox}
\tcbuselibrary{hooks, breakable, skins, theorems}
\usepackage{nccmath}
% do not break line after tcolorbox
\makeatletter
\tcbset{
  after app={%
    \ifx\tcb@drawcolorbox\tcb@drawcolorbox@breakable
    \else
      % add only when not breakabel
      \@endparenv
    \fi
  }
}
\appto\tcb@use@after@lastbox{\@endparenv\@doendpe}
\makeatother
\newcommand\extraInfo[2]{
\begin{tcolorbox}[colback=black!5!white,
    colframe=black!5!white,
    sharp corners, 
    breakable, 
    boxrule=0pt, 
    before upper={\parindent2em\parskip3pt},
    fonttitle={\bfseries}, 
    title={\textcolor{black}{#1}},
    top=0pt,
    toptitle=3pt,
    ]%
    \kaishu\small%
    #2%\normalfont\normalsize
\end{tcolorbox}
}
\newcommand\suppInfo[2]{
\begin{tcolorbox}[colback=fudanOrange!5!white,
    colframe=fudanOrange!5!white,
    sharp corners, 
    breakable, 
    boxrule=0pt, 
    before upper={\parindent2em\parskip3pt},
    fonttitle={\bfseries}, 
    title={\textcolor{black}{#1}}
    ]%
    \kaishu\small%
    #2%\normalfont\normalsize
\end{tcolorbox}
}
\newcommand\chat[1]{
\begin{tcolorbox}[colback=black!2!white,
    colframe=black!2!white,
    % sharp corners, 
    breakable, 
    boxrule=0pt, 
    before upper={\parindent2em\parskip3pt},
    left=3pt,
    right=3pt,
    left skip=10pt,
    right skip=10pt,
    arc=4mm,
    enhanced jigsaw,
    % ams nodisplayskip,
    % fonttitle={\bfseries}, 
    % title={\textcolor{black}{#1}}
    ]%
    % \setlength\abovedisplayskip{-5pt}% %% it doesn't work. sad  :-(
    % \setlength\belowdisplayskip{-5pt}%
    % \setlength\abovedisplayshortskip{-5pt}%
    % \setlength\belowdisplayshortskip{-5pt}%
    \setlength{\parskip}{1pt}%
    \noindent%\ignorespaces%
    \fangsong\small%
    #1
\end{tcolorbox}
}
\renewcommand\homework[1]{
\begin{tcolorbox}[colback=fudanBlue!5!white,
    colframe=fudanBlue!5!white,
    sharp corners, 
    breakable, 
    boxrule=0pt, 
    %before upper={\parindent2em\parskip3pt},
    fonttitle={\bfseries}, 
    title={\textcolor{black}{作业}},
    top=0pt,
    toptitle=3pt,
    ]%
    \kaishu%
    #1%\normalfont\normalsize
\end{tcolorbox}
}

% time stamp
\newcommand\courseTime[1]{%
    \marginpar{\small\kaishu\textcolor{gray}{\textsf{#1}}\normalfont}%
    \addcontentsline{ctime}{figure}{#1}%
}
\makeatletter
\newcommand\listctimename{时间戳 Timestamps}%
\newcommand\listofctimes{%
\chapter*{\listctimename}\@starttoc{ctime}%
\cleardoublepage
}%
\makeatother

\setlength{\parskip}{3pt}

\usepackage{enumerate}
\usepackage[shortlabels,inline]{enumitem}
\setlist{nolistsep}

\usepackage{listings}
\definecolor{dkgreen}{rgb}{0,0.6,0}
\definecolor{gray}{rgb}{0.5,0.5,0.5}
\definecolor{mauve}{rgb}{0.58,0,0.82}
\definecolor{lightgray}{rgb}{0.98,0.98,0.98}
\usepackage{fontspec}
\setmonofont{Consolas}
\lstset{
language=Mathematica,
basicstyle=\footnotesize\ttfamily,           % the size of the fonts that are used for the code
numbers=left,                   % where to put the line-numbers
numberstyle=\tiny\color{gray},  % the style that is used for the line-numbers
stepnumber=1,                   % the step between two line-numbers. If it's 1, each line 
                                % will be numbered
numbersep=5pt,                  % how far the line-numbers are from the code
backgroundcolor=\color{lightgray},      % choose the background color. You must add \usepackage{color}
showspaces=false,               % show spaces adding particular underscores
showstringspaces=false,         % underline spaces within strings
showtabs=false,                 % show tabs within strings adding particular underscores
frame=none,                   % adds a frame around the code
rulecolor=\color{black},        % if not set, the frame-color may be changed on line-breaks within not-black text (e.g. commens (green here))
tabsize=4,                      % sets default tabsize to 2 spaces
captionpos=b,                   % sets the caption-position to bottom
breaklines=true,                % sets automatic line breaking
breakatwhitespace=false,        % sets if automatic breaks should only happen at whitespace
title=\lstname,                   % show the filename of files included with \lstinputlisting;
                                % also try caption instead of title
keywordstyle=\color{fudanBlue},          % keyword style
commentstyle=\color{dkgreen},       % comment style
stringstyle=\color{mauve},         % string literal style
escapeinside={\%*}{*)},            % if you want to add LaTeX within your code
morekeywords={*,...},               % if you want to add more keywords to the set
belowskip=-1.0 \baselineskip,
xleftmargin=24pt,
xrightmargin=24pt,
% framerule=10pt,
}

\usepackage{hyperref}
\hypersetup{
    breaklinks,
    unicode,
    linktoc=all,
    bookmarksnumbered=true,
    bookmarksopen=true,
    colorlinks,
    linkcolor=fudanRed,
    citecolor=fudanRed,
    urlcolor=fudanRed,
    plainpages=false,
    pdfstartview=FitH,
    pdfborder={0 0 0},
    linktocpage
}
\usepackage{cleveref} % reference for tcolorbox

\title{\Huge \textbf{量子化学原理与应用} \\
% \footnote{This is a footnote.} \\ 
\huge 课堂内容记录 
% \footnote{This is yet another footnote.}
}
% Author
\author{
    % \textsc{First-name Last-name}\thanks{\url{www.example.com}}
主讲人：张颖  Igor Ying Zhang\\
~\\
\normalsize
GitHub: \url{https://github.com/fanwenbin95/QC2022Fall}
}


\begin{document}

\frontmatter
\maketitle

\tableofcontents
\listoffigures
% \listoftables

\mainmatter
\input{w01.tex}
\input{w02.tex}
\input{w03.tex}
\input{w04.tex}
\input{w05.tex}
\input{w06.tex}
\input{w07.tex}
\input{w08.tex}
\input{w09.tex}
\input{w10.tex}
\input{w11.tex}
\input{w12.tex}
\input{sol.tex}

\backmatter
\printindex
\listofctimes
\end{document}